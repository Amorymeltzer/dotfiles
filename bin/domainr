#!/usr/bin/env python
# coding=UTF-8
# https://github.com/talsafran/domainr
# Tweaked the colors to be regular intensity, added symbols

from sys import argv
from httplib import HTTPSConnection

import json

colors = {
    'green':  '\033[0;32m',
    'yellow': '\033[0;33m',
    'red':    '\033[0;31m',
    'endc':   '\033[0m'
}

status_color = {
    'available':    colors['green'],
    'maybe':        colors['yellow'],
    'taken':        colors['red'],
    'unavailable':  colors['red']
}

# ✓ ✗
status_symbol = {
    'available':    u"✓",
    'maybe':        u"?",
    'taken':        u"✗",
    'unavailable':  u"✗"
    }

def main(args):
    con = HTTPSConnection('domainr.com')

    for arg in args:
        print "Looking up domains for %s...\n" % arg

        req = con.request('GET', '/api/json/search?q=%s' % arg)
        res = con.getresponse()

        if res.status == 200:
            data = res.read()
            sites = json.loads(data)

            for s in sites['results']:
                status = "%s%s - %s" % (s['domain'], s['path'], s['availability'])
                print status_color.get(s['availability'], '') + status_symbol.get(s['availability'], '') + "\t" + status + colors['endc']
            else:
                print "\nUh oh, you got a %s %s. What the dilly?" % (res.status, res.reason)

if __name__ == "__main__":
    main(argv[1:])
