# Bash completion for macports port command
# Amory Meltzer March 2014
_port()
{
    local cur prev acts opts

    COMPREPLY=()
    cur="${COMP_WORDS[COMP_CWORD]}"
    prev="${COMP_WORDS[COMP_CWORD-1]}"

    acts="activate archive build cat clean configure contents deactivate dependents deps destroot dir distcheck distclean dmg echo edit extract fetch file help info install installed list livecheck location mpkg outdated patch pkg provides rpmpackage search selfupdate sync test unarchive uninstall upgrade variants version"
    opts="-v -d -q -D -k -n -a -u -f -s -b -o"

    COMPREPLY=( $(compgen -W "${acts} ${opts}" -- ${cur}) )

    if [[ ${cur} == -* ]] ; then
	COMPREPLY=( $(compgen -W "${opts}" -- ${cur}) )
    fi

     case $prev in
	 activate)
	     COMPREPLY=$(port echo inactive | cut -f 1 -d " ")
	     COMPREPLY=( $(compgen -W "$COMPREPLY" -- ${cur}) )
	     return 0
	     ;;
	 deactivate)
	     COMPREPLY=$(port echo active | cut -f 1 -d " ")
	     COMPREPLY=( $(compgen -W "$COMPREPLY" -- ${cur}) )
	     return 0
	     ;;
	 echo|list)
	     COMPREPLY=( $(compgen -W "all installed leaves outdated active inactive" -- ${cur}) )
	     return 0
	     ;;
	 upgrade)
	    COMPREPLY=( $(compgen -W "all installed leaves outdated active inactive" -- ${cur}) )
	    return 0
	    ;;
	 uninstall)
	     COMPREPLY=$(port echo installed | cut -f 1 -d " ")
	     COMPREPLY=( $(compgen -W "$COMPREPLY leaves inactive" -- ${cur}) )
	    return 0
	    ;;
    esac
}
complete -F _port port
